@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light theme */
    --background: #FAFAFA;
    --surface: #FFFFFF;
    --surface-raised: #FFFFFF;
    --surface-subtle: #F5F5F5;
    --surface-active: #EAEAEA;
    --surface-hover: rgba(0, 0, 0, 0.02);
    --border: #E5E5E5;
    --border-subtle: #F0F0F0;
    --border-hover: #D4D4D4;
    
    --text-primary: #171717;
    --text-secondary: #525252;
    --text-tertiary: #A3A3A3;
    --text-inverse: #FFFFFF;

    --card-task: #3B82F6;
    --card-task-bg: #EFF6FF;
    --card-task-border: #BFDBFE;
    --card-story: #22C55E;
    --card-story-bg: #F0FDF4;
    --card-story-border: #BBF7D0;
    --card-epic: #A855F7;
    --card-epic-bg: #FAF5FF;
    --card-epic-border: #E9D5FF;
    --card-utility: #6B7280;
    --card-utility-bg: #F9FAFB;
    --card-utility-border: #E5E7EB;

    --success: #22C55E;
    --warning: #F59E0B;
    --error: #EF4444;
    --info: #3B82F6;

    --board-gradient-purple: linear-gradient(135deg, #E9D5FF 0%, #C4B5FD 50%, #818CF8 100%);
    --board-gradient-yellow: linear-gradient(135deg, #FEF3C7 0%, #FCD34D 50%, #F59E0B 100%);
    --board-gradient-blue: linear-gradient(135deg, #DBEAFE 0%, #93C5FD 50%, #3B82F6 100%);
    --board-gradient-green: linear-gradient(135deg, #DCFCE7 0%, #86EFAC 50%, #22C55E 100%);
    --board-gradient-pink: linear-gradient(135deg, #FCE7F3 0%, #F9A8D4 50%, #EC4899 100%);
    --board-gradient-teal: linear-gradient(135deg, #CCFBF1 0%, #5EEAD4 50%, #0D9488 100%);
    --board-gradient-red: linear-gradient(135deg, #FEE2E2 0%, #FCA5A5 50%, #EF4444 100%);

    --grain: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
  }

  .dark {
    /* Noir dark variant */
    --background: #0A0A0F;
    --surface: #12121A;
    --surface-raised: #22222E;
    --surface-subtle: #171722;
    --surface-active: #1A1A26;
    --surface-hover: rgba(255, 255, 255, 0.04);
    --border: rgba(255, 255, 255, 0.10);
    --border-subtle: rgba(255, 255, 255, 0.06);
    --border-hover: rgba(255, 255, 255, 0.16);
    
    --text-primary: #F0ECE4;
    --text-secondary: #A8A3B2;
    --text-tertiary: #7A7488;
    --text-inverse: #0A0A0F;

    --card-task: #4488FF;
    --card-task-bg: rgba(68, 136, 255, 0.10);
    --card-task-border: rgba(68, 136, 255, 0.28);
    --card-story: #00D4AA;
    --card-story-bg: rgba(0, 212, 170, 0.10);
    --card-story-border: rgba(0, 212, 170, 0.28);
    --card-epic: #9966FF;
    --card-epic-bg: rgba(153, 102, 255, 0.10);
    --card-epic-border: rgba(153, 102, 255, 0.28);
    --card-utility: #8A8694;
    --card-utility-bg: rgba(138, 134, 148, 0.12);
    --card-utility-border: rgba(138, 134, 148, 0.30);

    --success: #00D4AA;
    --warning: #FFAA00;
    --error: #FF3366;
    --info: #4488FF;

    --board-gradient-purple: linear-gradient(135deg, #2E1065 0%, #4C1D95 50%, #7C3AED 100%);
    --board-gradient-yellow: linear-gradient(135deg, #422006 0%, #713F12 50%, #CA8A04 100%);
    --board-gradient-blue: linear-gradient(135deg, #172554 0%, #1E3A8A 50%, #2563EB 100%);
    --board-gradient-green: linear-gradient(135deg, #052E16 0%, #14532D 50%, #16A34A 100%);
    --board-gradient-pink: linear-gradient(135deg, #500724 0%, #831843 50%, #DB2777 100%);
    --board-gradient-teal: linear-gradient(135deg, #042F2E 0%, #115E59 50%, #0F766E 100%);
    --board-gradient-red: linear-gradient(135deg, #450A0A 0%, #7F1D1D 50%, #DC2626 100%);
  }

  .slate {
    /* Slate dark variant: brighter surfaces, softer contrast */
    --background: #151922;
    --surface: #1C2230;
    --surface-raised: #272F42;
    --surface-subtle: #222A3A;
    --surface-active: #2A3348;
    --surface-hover: rgba(255, 255, 255, 0.05);
    --border: rgba(255, 255, 255, 0.12);
    --border-subtle: rgba(255, 255, 255, 0.08);
    --border-hover: rgba(255, 255, 255, 0.18);

    --text-primary: #E9E7E2;
    --text-secondary: #B8B4C0;
    --text-tertiary: #938EA0;
    --text-inverse: #151922;

    --card-task: #5A97F8;
    --card-task-bg: rgba(90, 151, 248, 0.12);
    --card-task-border: rgba(90, 151, 248, 0.26);
    --card-story: #2ECBB2;
    --card-story-bg: rgba(46, 203, 178, 0.12);
    --card-story-border: rgba(46, 203, 178, 0.26);
    --card-epic: #A985F8;
    --card-epic-bg: rgba(169, 133, 248, 0.12);
    --card-epic-border: rgba(169, 133, 248, 0.26);
    --card-utility: #9A96A6;
    --card-utility-bg: rgba(154, 150, 166, 0.14);
    --card-utility-border: rgba(154, 150, 166, 0.28);

    --success: #2ECBB2;
    --warning: #F3B24B;
    --error: #F25C84;
    --info: #5A97F8;

    --board-gradient-purple: linear-gradient(135deg, #312E81 0%, #6D28D9 50%, #8B5CF6 100%);
    --board-gradient-yellow: linear-gradient(135deg, #78350F 0%, #B45309 50%, #F59E0B 100%);
    --board-gradient-blue: linear-gradient(135deg, #1E3A8A 0%, #2563EB 50%, #60A5FA 100%);
    --board-gradient-green: linear-gradient(135deg, #14532D 0%, #16A34A 50%, #4ADE80 100%);
    --board-gradient-pink: linear-gradient(135deg, #831843 0%, #BE185D 50%, #F472B6 100%);
    --board-gradient-teal: linear-gradient(135deg, #134E4A 0%, #0F766E 50%, #2DD4BF 100%);
    --board-gradient-red: linear-gradient(135deg, #7F1D1D 0%, #B91C1C 50%, #F87171 100%);
  }

  .sparkle {
    /* Sparkle: glossy pink UI with pastel rainbow accents */
    --background: #FFD6EA;
    --surface: #FFE9F4;
    --surface-raised: #FFF4FA;
    --surface-subtle: #FFDCEB;
    --surface-active: #FFC8E2;
    --surface-hover: rgba(255, 92, 166, 0.12);
    --border: #F5A5CC;
    --border-subtle: #FBC8DF;
    --border-hover: #EC7BB5;

    --text-primary: #5A2140;
    --text-secondary: #874A67;
    --text-tertiary: #B97A98;
    --text-inverse: #FFF6FB;

    --card-task: #59A7FF;
    --card-task-bg: rgba(89, 167, 255, 0.16);
    --card-task-border: rgba(89, 167, 255, 0.35);
    --card-story: #38D29F;
    --card-story-bg: rgba(56, 210, 159, 0.15);
    --card-story-border: rgba(56, 210, 159, 0.34);
    --card-epic: #E45CC6;
    --card-epic-bg: rgba(228, 92, 198, 0.16);
    --card-epic-border: rgba(228, 92, 198, 0.36);
    --card-utility: #9A7390;
    --card-utility-bg: rgba(154, 115, 144, 0.15);
    --card-utility-border: rgba(154, 115, 144, 0.3);

    --success: #36C68D;
    --warning: #F6A447;
    --error: #F04E89;
    --info: #5F8FFF;

    --board-gradient-purple: linear-gradient(135deg, #F4C8FF 0%, #E6B8FF 45%, #B5A8FF 100%);
    --board-gradient-yellow: linear-gradient(135deg, #FFE9A8 0%, #FFD083 45%, #FFB36B 100%);
    --board-gradient-blue: linear-gradient(135deg, #BFE9FF 0%, #9FD5FF 45%, #78C0FF 100%);
    --board-gradient-green: linear-gradient(135deg, #CBF9DF 0%, #A8F0CB 45%, #7EE6B4 100%);
    --board-gradient-pink: linear-gradient(135deg, #FFD9EE 0%, #FFB8DE 45%, #FF8DC5 100%);
    --board-gradient-teal: linear-gradient(135deg, #C5F8F0 0%, #9AEFDF 45%, #64E5CE 100%);
    --board-gradient-red: linear-gradient(135deg, #FFD1DC 0%, #FFB0C5 45%, #FF88AD 100%);
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-text-primary;
    font-feature-settings: "rlig" 1, "calt" 1;
  }

  .dark body::before,
  .slate body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: var(--grain);
    pointer-events: none;
    z-index: 1000;
  }

  .sparkle body {
    font-family: "Trebuchet MS", "Verdana", "Tahoma", sans-serif;
  }
}

@layer components {
  /* Sparkle skin retro chrome */
  .sparkle {
    --sparkle-panel-top: #fff4fb;
    --sparkle-panel-bottom: #ffd8ea;
    --sparkle-hard-shadow: rgba(175, 61, 120, 0.28);
  }

  .sparkle main {
    background-image:
      radial-gradient(circle at 100% 0%, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0) 38%),
      repeating-linear-gradient(
        -45deg,
        rgba(255, 255, 255, 0.1) 0px,
        rgba(255, 255, 255, 0.1) 2px,
        rgba(255, 255, 255, 0) 2px,
        rgba(255, 255, 255, 0) 8px
      );
  }

  .sparkle header {
    background: linear-gradient(180deg, #ffeef7 0%, #ffd9ea 100%);
    border-bottom-color: #ef94be;
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.9),
      inset 0 -1px 0 rgba(223, 115, 169, 0.28);
  }

  .sparkle nav a {
    border: 1px solid transparent;
  }

  .sparkle nav a:hover {
    border-color: #e88fb9;
  }

  .sparkle nav a.bg-primary\/10 {
    border-color: #da6ea8;
    background:
      linear-gradient(180deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0)),
      linear-gradient(135deg, rgba(255, 206, 231, 0.86), rgba(217, 239, 255, 0.78));
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      inset 0 -1px 0 rgba(212, 91, 154, 0.3);
  }

  .sparkle button,
  .sparkle [role='button'],
  .sparkle [role='combobox'],
  .sparkle input,
  .sparkle textarea {
    border-color: #e98ab7;
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      inset 0 -1px 0 rgba(221, 103, 163, 0.24),
      0 1px 0 rgba(255, 255, 255, 0.7);
  }

  .sparkle button:not([class*='bg-']),
  .sparkle [role='button']:not([class*='bg-']),
  .sparkle [role='combobox']:not([class*='bg-']) {
    background:
      linear-gradient(180deg, rgba(255, 255, 255, 0.72), rgba(255, 255, 255, 0)),
      linear-gradient(180deg, var(--sparkle-panel-top), var(--sparkle-panel-bottom));
  }

  .sparkle button:not([class*='bg-']):hover,
  .sparkle [role='button']:not([class*='bg-']):hover,
  .sparkle [role='combobox']:not([class*='bg-']):hover {
    background-image:
      linear-gradient(180deg, rgba(255, 255, 255, 0.36), rgba(255, 255, 255, 0)),
      linear-gradient(180deg, #fff8fd, #ffd9ea);
    border-color: #df6ca8;
  }

  .sparkle button:not([class*='bg-']):active,
  .sparkle [role='button']:not([class*='bg-']):active,
  .sparkle [role='combobox']:not([class*='bg-'])[data-state='open'] {
    box-shadow:
      inset 0 2px 4px rgba(168, 55, 114, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.6);
    transform: none;
  }

  .sparkle input,
  .sparkle textarea {
    background:
      linear-gradient(180deg, rgba(255, 255, 255, 0.72), rgba(255, 255, 255, 0)),
      linear-gradient(180deg, #fffafc, #ffe8f2);
  }

  .sparkle .card-base {
    border-color: #ea9bc1;
    background-image:
      linear-gradient(180deg, rgba(255, 255, 255, 0.42), rgba(255, 255, 255, 0)),
      linear-gradient(135deg, rgba(255, 194, 225, 0.32), rgba(255, 240, 248, 0.26));
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      inset 0 -1px 0 rgba(221, 103, 163, 0.2),
      0 3px 10px rgba(201, 77, 145, 0.15);
    position: relative;
  }

  .sparkle .card-base::after {
    content: '';
    position: absolute;
    top: 1px;
    right: 8px;
    width: 24px;
    height: 10px;
    border-radius: 99px;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.75), rgba(255, 255, 255, 0));
    pointer-events: none;
  }

  .sparkle .badge {
    border: 1px solid #eca3c8;
    background: linear-gradient(180deg, #fff5fb 0%, #ffdfee 100%);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.95);
  }

  .sparkle [data-radix-popper-content-wrapper] > * {
    border-color: #e88fba;
    background-image:
      linear-gradient(180deg, rgba(255, 255, 255, 0.48), rgba(255, 255, 255, 0)),
      linear-gradient(145deg, #ffe7f3, #ffd5e8);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      0 10px 24px rgba(190, 69, 133, 0.2);
  }

  .sparkle [data-radix-popper-content-wrapper] [role='menuitemradio'][data-highlighted],
  .sparkle [data-radix-popper-content-wrapper] [role='menuitem'][data-highlighted],
  .sparkle [data-radix-popper-content-wrapper] [role='option'][data-highlighted] {
    background: linear-gradient(90deg, rgba(255, 203, 227, 0.78), rgba(221, 241, 255, 0.72));
    color: #5a2140;
  }

  .sparkle .ui-dialog-content {
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    max-height: calc(100vh - 4rem);
    border-color: #e889b7;
    background-image:
      linear-gradient(180deg, rgba(255, 255, 255, 0.44), rgba(255, 255, 255, 0)),
      linear-gradient(145deg, #ffebf5, #ffd9eb);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      0 22px 46px rgba(181, 62, 125, 0.25);
  }

  .sparkle .ui-dialog-content[data-state='open'],
  .sparkle .ui-dialog-content[data-state='closed'] {
    animation: none !important;
  }

  .sparkle .sparkle-icon-chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    border-radius: 5px;
    border: 1px solid #dc6aa7;
    background:
      linear-gradient(180deg, rgba(255, 255, 255, 0.72), rgba(255, 255, 255, 0)),
      linear-gradient(140deg, #ffc3df, #d6ecff 52%, #fff2b8);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.95),
      0 1px 2px var(--sparkle-hard-shadow);
  }

  .sparkle .sparkle-icon-glyph {
    color: #7b2a54;
    stroke-width: 2.2;
    filter: drop-shadow(0 1px 0 rgba(255, 255, 255, 0.55));
  }

  .sparkle button .sparkle-icon-glyph,
  .sparkle [role='button'] .sparkle-icon-glyph {
    color: #6f1f49;
  }

  /* Card base styles */
  .card-base {
    @apply bg-surface border border-border-subtle rounded-card p-card;
    @apply cursor-pointer transition-colors duration-micro;
    @apply hover:bg-surface-hover;
  }

  .card-task {
    @apply card-base border-l-[3px] border-l-card-task;
  }

  .card-story {
    @apply card-base border-l-[3px] border-l-card-story;
  }

  .card-epic {
    @apply card-base border-l-[3px] border-l-card-epic;
  }

  .card-utility {
    @apply card-base border-l-[3px] border-l-card-utility;
  }

  /* Progress bar */
  .progress-bar {
    @apply h-1 bg-border rounded-sm overflow-hidden;
  }

  .progress-bar-fill {
    @apply h-full rounded-sm transition-all duration-complex;
  }

  /* Badge base */
  .badge {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5;
    @apply bg-surface-raised rounded text-caption;
  }

  /* Focus styles */
  .focus-ring {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-text-primary focus-visible:ring-offset-2;
  }
}

@layer utilities {
  /* Truncate text */
  .truncate-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}
